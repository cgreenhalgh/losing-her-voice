<h1 [ngClass]="{dark: view && view.dark}">
	<span *ngIf="!view" class="button" (click)="onShowMenu()"><mat-icon>menu</mat-icon></span>
	<span>
	Losing Her Voice 
	</span>
	<span (click)="toggleFullScreen()" class="toggleFullscreen"><mat-icon>fullscreen</mat-icon><!-- (toggle fullscreen) --></span>
</h1>

<div *ngIf="loading" padding>
  Loading...
</div>
<div *ngIf="currentState && currentState.error" padding>
  Sorry, {{currentState.error}}
</div>
<div class="sidenav" [ngClass]="{'sidenavopen': showMenu && !view}">
  <a href="javascript:void(0)" class="closebtn" (click)="onShowMenu()">&times;</a>
  <div *ngFor="let menuItem of menuItems">
    <div class="button" (click)="onShowMenuItem(menuItem)">{{menuItem.title}}<mat-icon *ngIf="menuItem.highlight">create</mat-icon></div>
  </div>
</div>
<div class="flickerDiv" #flickerDiv>
  <div #flickerImg class="flickerInner">
    <img *ngIf="flickerImage" [src]="flickerImage" class="flickerImg">
  </div>
</div>
<div *ngIf="view && !view.showItems" [ngClass]="{dark: view && view.dark}">
  <div><hr [ngClass]="{dark: view && view.dark}"></div>
  <div *ngFor="let card of view.cards">
    <div [innerHTML]="card.html"></div>
    <div><hr [ngClass]="{dark: view && view.dark}"></div>
  </div>
  <div *ngIf="showPlay">
    <div class="button" (click)="onPlayAudio()">Play</div>
  </div>
</div>
<div *ngIf="view && view.showItems" [ngClass]="{dark: view && view.dark}">
	<div class="profile_name" (click)="onToggleEditProfile()">
		{{profileName}}<mat-icon *ngIf="!profileName" >create</mat-icon>
	</div>
	<profile-view *ngIf="editProfile" (fullNameSet)="onToggleEditProfile()"></profile-view>
	<div *ngIf="!editProfile"><hr></div>
	<div *ngIf="selfieConfirmed && !!profileName && !selfieSent && view.postSelfie" class="row">
		<div class="item_like" [ngClass]="{item_liked: selfieSent, disabled: !selfieConfirmed || !profileName}" (click)="onShareSelfie()">Publish my Selfie</div>
	</div>
  <div *ngIf="currentItem && !currentItemIsBlank" class="item">
		<div *ngIf="currentRepostItem" class="item_repost_header"><em>{{currentRepostItem.user_name}}</em> shared</div>
		<div class="item_header">
			<div class="item_user_icon"><img class="item_user_icon" [src]="currentItem.user_icon"></div>
			<div class="item_header2">
				<div class="item_title">{{currentItem.user_name}}</div>
				<div class="item_date">{{currentItem.date}}</div>
			</div>
		</div>
		<div *ngIf="currentSimpleItem" class="item_content">{{currentSimpleItem.content}}</div>
		<div *ngIf="currentSimpleItem && currentSimpleItem.image" class="item_image"><img class="item_image" [src]="currentSimpleItem.image"></div>
		<div *ngIf="currentQuizItem" class="quiz_question">{{currentQuizItem.content}}</div>
		<div *ngIf="currentQuizItem">
			<div *ngFor="let option of currentQuizItem.options; index as optionIndex" class="quiz_option" 
			[ngClass]="{quiz_selected: option.selected, quiz_correct: currentQuizItem.closed && option.correct, quiz_incorrect: currentQuizItem.closed && currentQuizItem.itemType=='quiz' && !option.correct}">
				<div class="quiz_option_content" (click)="selectQuizOption(optionIndex)"><div>{{option.content}}</div></div>
				<div *ngIf="currentQuizItem.closed" class="quiz_option_count"><div>{{option.count}}</div></div>
			</div>
			<div class="quiz_prompt" *ngIf="!currentQuizItem.closed">{{currentQuizItem.openPrompt}}</div>
			<div class="quiz_prompt" *ngIf="currentQuizItem.closed">{{currentQuizItem.closedPrompt}}</div>
		</div>
  </div>
  <div class="row">
    <div class="half">
      <div *ngIf="currentSimpleItem && currentSimpleItem.canLike" class="item_like" [ngClass]="{item_liked: currentItemLiked}" (click)="onLikeCurrentItem()">Like</div>
    </div>
    <div class="half">
      <div *ngIf="currentSimpleItem && currentSimpleItem.canShare" class="item_like" [ngClass]="{item_liked: currentItemShared, disabled: !profileName}" (click)="onShareCurrentItem()">Share</div>
    </div>
    <div *ngIf="currentQuizItem && !currentQuizItem.closed" class="item_like" [ngClass]="{item_liked: currentItemSent, disabled: !currentItemSelected}" (click)="onSendCurrentItem()">Send</div>
  </div>
</div>
<audio #audio (readystatechange)="onAudioReadyStateChange()" (canplay)="onCanPlay()" (load)="onLoad()"></audio>

<div *ngIf="showLanding" [ngClass]="{landing: true, touched: landingTouched}" (touchstart)="onTouchLanding()" (touchend)="onDismissLanding($event)" (mousedown)="onTouchLanding()" (mouseup)="onDismissLanding($event)">
  <p>Touch to start...</p>
</div>

<router-outlet *ngIf="!view"></router-outlet>
